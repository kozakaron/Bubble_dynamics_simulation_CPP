# Bubble_dynamics_simulation_CPP
A CPP and CUDA powered version of Bubble_dynamics_simulation.

## Content
 * **bin:** Stores compiled executables, object files, shared libraries. Automatically created and purged by [./dev/build.py](./dev/build.py).
 * **dev:** Developer tools written in Python.
    * **build.py:** Used to compile the code. See `python3 ./dev/build.py --help` or the next chapter.
    * **inp_data_extractor:** Automatically generates mechanism headers from chemkin input (.inp) files. Usage: `python3 ./dev/inp_data_extractor.py --file path/example.inp --name my_mechanism_name`. Neither argument is required. The script can also automatically list .inp files in the current working directory and ask for the user's choice. The name of the .inp file is used as default mechanism name. File is generated in *./mechanism*.
    * molecular_data.py: Used by [./dev/inp_data_extractor.py](./dev/inp_data_extractor.py).
 * **include:** Header files.
    * **common.h:** Stores useful utilities: Timer class, benchmark macro, formatter strings.
    * **test.h:** Simple unit test framework.
    * **ode_fun.h:** Computations for the right hand side of the ordinary differential equation.
 * **mechanism:** Stores automatically generated headers generated by [./dev/inp_data_extractor.py](./dev/inp_data_extractor.py), except for [./mechanism/parameters.h](./mechanism/parameters.h), which holds universal constants and includes the appropiate mechanism.
  * **src:** Holds the source codes corresponding to headers in [./include](./include/).
    * **main.cpp:** The main entry point for the program.
 * **test:** Holds unit tests and benchmarks.
    * **test_list.h:** A list of all tests and benchmarks.

## Prerequisits

 * Python3 (with numpy and termcolor)
 * clang++ compiler
 * gnu g++ compiler
 * gnu gdb debugger

 ## Compilation

 Use the [./dev/build.py](./dev/build.py) script. The script will automaticly locate mechanism and ask you to choose. Each *.cpp* file will be compiled into an object file on a seperate thread and then linked togeather. Syntax colored error messages are printed grouped by cpp file. Use flags `--test`, `--benchmark` to run unit tests or benchmarks respectively. Use `--run` to run the executable automatically after compilation. The full list of flags are available here:

~~~
  -h, --help        show this help message and exit
  -t, --test        build with test flag (TEST is defined)
  -b, --benchmark   build with benchmark flag (BENCHMARK is defined)
  -r, --run         run the binary after building
  -w, --warning     enable all warnings
  -d, --debug       compile in debug mode (also runs gdb if called with -r)
  -s, --shared      build as shared library (.dll/.so)
  -o2, --optimize2  enable o2 optimization
  -o3, --optimize3  enable o3 optimization
~~~

In the top rows of [./dev/build.py](./dev/build.py), you may add new source/include directories. Furthermore, you may choose compiler (clang or gcc) or turn on and off certain compiler flags. You may have problem with the sanitizers, or with the long double. In the latter case, try to change `-mlong-double-80` to 64 or 128. For example you may compile run your tests and benchmarks as: `python3 ./dev/build.py --run --warning --optimize3 --benchmark --test`.
